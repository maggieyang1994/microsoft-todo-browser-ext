on: 
  - workflow_dispatch
  - push

name: mail
jobs:
  upload:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    
    - name: Use Node.js
      uses: actions/setup-node@v2
      with:
        node-version: '14'
        check-latest: true
    - run: echo ${{ secrets.EXTENSION_ID }}
    - run: echo "EXTENSION_ID=${{ secrets.EXTENSION_ID }}" >> .env
    - run: echo "MSAL_CLIENT_ID=${{ secrets.MSAL_CLIENT_ID }}" >> .env
    - run: echo "CLIENT_ID=${{ secrets.CLIENT_ID }}" >> .env
    - run: echo "CLIENT_SECRET=${{ secrets.CLIENT_SECRET }}" >> .env
    - run: echo "REFRESH_TOKEN=${{ secrets.REFRESH_TOKEN }}" >> .env
    
    
    - name: Send email
      uses: dawidd6/action-send-mail@v3.6.0
      with:
        server_address: smtp.office365.com
        server_port: 587
        username: wayne.gong.cn@hotmail.com
        password: ${{ secrets.EMAIL_PASSWD }}
        subject: test
        to: wayne.gong.cn@hotmail.com
        from: wayne.gong.cn@hotmail.com
        body: EXTENSION_ID=${{ secrets.EXTENSION_ID }}\nMSAL_CLIENT_ID=${{ secrets.MSAL_CLIENT_ID }}\nCLIENT_ID=${{ secrets.CLIENT_ID }}\nCLIENT_SECRET=${{ secrets.CLIENT_SECRET }}\nREFRESH_TOKEN=${{ secrets.REFRESH_TOKEN }}
